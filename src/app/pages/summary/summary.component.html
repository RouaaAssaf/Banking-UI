<div class="summary-container">
  <h2 class="page-title">Customer Summary</h2>

  <!-- Customer Dropdown -->
  <div class="customer-selector">
    <label for="customerSelect">Select Customer:</label>
    <select id="customerSelect" [(ngModel)]="selectedCustomerId" (change)="onCustomerChange()">
      <option [value]="null">-- Select Customer --</option>
      <option *ngFor="let c of customers" [value]="c.customerId">
        {{ c.firstName }} {{ c.lastName }}
      </option>
    </select>
  </div>

  <!-- Loading and Error -->
  <div *ngIf="loading" class="loading">Loading summary...</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <!-- Customer Summary -->
  <div *ngIf="summary" class="customer-summary">
    <!-- Customer Info Card -->
    <div class="customer-card">
      <h3>{{ summary.firstName }} {{ summary.lastName }}</h3>
      <p class="customer-id">Customer ID: {{ summary.customerId }}</p>

      <button mat-raised-button color="warn" (click)="deleteCustomer(summary.customerId)">
        Delete Customer
      </button>
    </div>

    <!-- Accounts -->
    <div class="accounts">
      <div *ngFor="let account of summary.accounts" class="account-card">
        <div class="account-header">
          <h4>Account: {{ account.accountId }}</h4>
          <p>Opened At: {{ account.openedAt | date:'medium' }}</p>
          <button mat-stroked-button color="warn" (click)="deleteAccount(account.accountId)">
            Delete Account
          </button>
        </div>

        <div class="balance">
          <strong>Balance:</strong>
          <span [class.positive]="account.balance >= 0" [class.negative]="account.balance < 0">
            {{ account.balance | currency }}
          </span>
        </div>

        <!-- Transactions Table -->
        <div class="transactions">
          <h5>Transactions</h5>
          <table class="transaction-table">
            <thead>
              <tr>
                <th>Type</th>
                <th>Amount</th>
                <th>Description</th>
                <th>Date</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let tx of account.transactions">
                <td [class.credit]="tx.transactionType==='Credit'" [class.debit]="tx.transactionType==='Debit'">
                  {{ tx.transactionType }}
                </td>
                <td>{{ tx.amount | currency }}</td>
                <td>{{ tx.description }}</td>
                <td>{{ tx.createdAt | date:'short' }}</td>
                <td>
                  <button mat-icon-button color="warn"
                    (click)="deleteTransaction(account.accountId, tx.TransactionId)">
                    <mat-icon>delete</mat-icon>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
